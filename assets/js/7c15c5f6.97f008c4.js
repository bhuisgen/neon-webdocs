"use strict";(self.webpackChunkneon_webdocs=self.webpackChunkneon_webdocs||[]).push([[4447],{992:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>d,contentTitle:()=>o,default:()=>h,frontMatter:()=>l,metadata:()=>t,toc:()=>a});var s=i(4848),r=i(8453);const l={toc_max_heading_level:2},o="logger",t={id:"neon/configuration/server/sites/modules/middlewares/logger/index",title:"logger",description:"The logger middleware allows to writes access logs.",source:"@site/docs/neon/configuration/server/sites/modules/middlewares/logger/index.md",sourceDirName:"neon/configuration/server/sites/modules/middlewares/logger",slug:"/neon/configuration/server/sites/modules/middlewares/logger/",permalink:"/neon-webdocs/neon/configuration/server/sites/modules/middlewares/logger/",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{toc_max_heading_level:2},sidebar:"docsSidebar",previous:{title:"header",permalink:"/neon-webdocs/neon/configuration/server/sites/modules/middlewares/header/"},next:{title:"rewrite",permalink:"/neon-webdocs/neon/configuration/server/sites/modules/middlewares/rewrite/"}},d={},a=[{value:"Example configuration",id:"example-configuration",level:2},{value:"Directives",id:"directives",level:2},{value:"<code>file</code>",id:"file",level:3},{value:"<code>format</code>",id:"format",level:3},{value:"<code>bufferSize</code>",id:"bufferSize",level:3},{value:"<code>bufferFlush</code>",id:"bufferFlush",level:3},{value:"<code>filters</code>",id:"filters",level:3}];function c(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.h1,{id:"logger",children:"logger"}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.code,{children:"logger"})," middleware allows to writes access logs."]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#example-configuration",children:"Example configuration"})}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"#directives",children:"Directives"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#file",children:(0,s.jsx)(n.code,{children:"file"})})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#format",children:(0,s.jsx)(n.code,{children:"format"})})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#bufferSize",children:(0,s.jsx)(n.code,{children:"bufferSize"})})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#bufferFlush",children:(0,s.jsx)(n.code,{children:"bufferFlush"})})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#filters",children:(0,s.jsx)(n.code,{children:"filters"})})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.admonition,{type:"warning",children:(0,s.jsx)(n.p,{children:"This middleware should be the first middleware of the chain to output real request processing timings."})}),"\n",(0,s.jsx)(n.h2,{id:"example-configuration",children:"Example configuration"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"sites:\n  default:\n    routes:\n      default:\n        middlewares:\n          logger:\n"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"The logging middleware outputs all incoming requests to the standard output i.e. the console."}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"directives",children:"Directives"}),"\n",(0,s.jsx)(n.h3,{id:"file",children:(0,s.jsx)(n.code,{children:"file"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"    Syntax:         file: <file>\n    Type:           string\n"})}),"\n",(0,s.jsx)(n.p,{children:"Set the log file name."}),"\n",(0,s.jsx)(n.admonition,{type:"info",children:(0,s.jsx)(n.p,{children:"By default the console is used as log output."})}),"\n",(0,s.jsx)(n.h3,{id:"format",children:(0,s.jsx)(n.code,{children:"format"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"    Syntax:         format: <name>\n    Type:           string\n    Valid values:   common, json\n    Default:        -\n"})}),"\n",(0,s.jsx)(n.p,{children:"The custom log format."}),"\n",(0,s.jsx)(n.admonition,{title:"neon-pro",type:"note",children:(0,s.jsx)(n.p,{children:"This feature is only available in Neon Pro."})}),"\n",(0,s.jsx)(n.p,{children:"Available formats:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"common"}),": common log format."]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:'  <ip> - - [<date>] "<method> <path> <proto>"<status> <bytes> "<referer>" "<user-agent>" <duration>ms\n'})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"json"}),": JSON format."]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'  {"ip": "<ip>", "date": "<date>", "request": {"method":"<method>","path":"<path>","proto":"<proto>"},"status:<status>,"bytes":<bytes>,"userAgent":"<user-agent>","duration":<duration>}\n'})}),"\n",(0,s.jsx)(n.p,{children:"If no format is specified, the logging uses this default format:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"    <method> <path> <status> <duration>\n"})}),"\n",(0,s.jsx)(n.h3,{id:"bufferSize",children:(0,s.jsx)(n.code,{children:"bufferSize"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"    Syntax:         bufferSize: <size>\n    Type:           numeric\n    Unit:           bytes\n    Minimum         0\n    Default:        -\n"})}),"\n",(0,s.jsx)(n.p,{children:"Enable the asynchronous writing of the log file by using a buffer of the given size in bytes."}),"\n",(0,s.jsx)(n.p,{children:"A value of 0 will set the default buffer size to 4 KB."}),"\n",(0,s.jsx)(n.admonition,{title:"neon-pro",type:"note",children:(0,s.jsx)(n.p,{children:"This feature is only available in Neon Pro."})}),"\n",(0,s.jsx)(n.h3,{id:"bufferFlush",children:(0,s.jsx)(n.code,{children:"bufferFlush"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"    Syntax:         bufferFlush: <delay>\n    Type:           numeric\n    Unit:           seconds\n    Minimum         0\n    Default:        -\n"})}),"\n",(0,s.jsx)(n.p,{children:"Enable the flushing of the log file buffer at each given delay in seconds."}),"\n",(0,s.jsx)(n.p,{children:"A value of 0 will set the default flushing interval to 10s."}),"\n",(0,s.jsx)(n.admonition,{title:"neon-pro",type:"note",children:(0,s.jsx)(n.p,{children:"This feature is only available in Neon Pro."})}),"\n",(0,s.jsx)(n.h3,{id:"filters",children:(0,s.jsx)(n.code,{children:"filters"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"    Syntax:         filters:\n    Type:           map\n    Item name:      string\n    Item value:     list\n    Default:        -\n"})}),"\n",(0,s.jsx)(n.p,{children:"The list of filters to limit the access logs."}),"\n",(0,s.jsx)(n.p,{children:"Only the requests validating all filters are logged."}),"\n",(0,s.jsx)(n.admonition,{title:"neon-pro",type:"note",children:(0,s.jsx)(n.p,{children:"This feature is only available in Neon Pro."})}),"\n",(0,s.jsx)(n.p,{children:"Available filters:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"statusCode"}),": limit access logs to the given status code(s) as a value or range."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"minDuration"}),": limit access logs to the minimal duration of requests in seconds or as a valid duration format (",(0,s.jsx)(n.a,{href:"https://pkg.go.dev/time#ParseDuration",children:"time.ParseDuration"}),")."]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Example"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:'filters:\n  statusCodes:\n    - "200"\n    - "300-302"\n  minDuration: "200ms"\n'})})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(c,{...e})}):c(e)}},8453:(e,n,i)=>{i.d(n,{R:()=>o,x:()=>t});var s=i(6540);const r={},l=s.createContext(r);function o(e){const n=s.useContext(l);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function t(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:o(e.components),s.createElement(l.Provider,{value:n},e.children)}}}]);