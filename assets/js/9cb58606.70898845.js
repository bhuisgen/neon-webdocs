"use strict";(self.webpackChunkneon_webdocs=self.webpackChunkneon_webdocs||[]).push([[7016],{941:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>a,contentTitle:()=>l,default:()=>h,frontMatter:()=>t,metadata:()=>d,toc:()=>o});var i=r(5893),s=r(1151);const t={toc_max_heading_level:2},l="Server",d={id:"neon/configuration/servers/server/index",title:"Server",description:"A server is the configuration block required to serve a site by the instance.",source:"@site/docs/neon/configuration/servers/server/index.md",sourceDirName:"neon/configuration/servers/server",slug:"/neon/configuration/servers/server/",permalink:"/neon-webdocs/neon/configuration/servers/server/",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{toc_max_heading_level:2},sidebar:"docsSidebar",previous:{title:"Overview",permalink:"/neon-webdocs/neon/configuration/servers/overview/"},next:{title:"compress",permalink:"/neon-webdocs/neon/configuration/servers/modules/middlewares/compress/"}},a={},o=[{value:"Example configuration",id:"example-configuration",level:2},{value:"Directives",id:"directives",level:2},{value:"<code>listeners</code>",id:"listeners",level:3},{value:"<code>routes</code>",id:"routes",level:3},{value:"<code>middlewares</code>",id:"routes-middlewares",level:4},{value:"<code>handler</code>",id:"routes-handler",level:4}];function c(e){const n={a:"a",admonition:"admonition",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",h4:"h4",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.a)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.h1,{id:"server",children:"Server"}),"\n",(0,i.jsx)(n.p,{children:"A server is the configuration block required to serve a site by the instance."}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"./#example-configuration",children:"Example configuration"})}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"./#directives",children:"Directives"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"./#listeners",children:(0,i.jsx)(n.code,{children:"listeners"})})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"./#hosts",children:(0,i.jsx)(n.code,{children:"hosts"})})}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"./#routes",children:(0,i.jsx)(n.code,{children:"routes"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"./#routes-middlewares",children:(0,i.jsx)(n.code,{children:"middlewares"})})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"./#routes-handler",children:(0,i.jsx)(n.code,{children:"handler"})})}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"example-configuration",children:"Example configuration"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:"servers:\n  default:\n    listeners:\n      - default\n    routes:\n      default:\n        middlewares:\n          static:\n            path: dist/app/static\n        handler:\n          app:\n            index: dist/app/index.html\n            bundle: dist/app/bundle.js\n  admin:\n    listeners:\n      - default\n    hosts:\n      - admin.example.org\n    routes:\n      default:\n        middlewares:\n          static:\n            path: dist/admin/static\n        handler:\n          app:\n            index: dist/admin/index.html\n            bundle: dist/admin/bundle.js\n"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Two servers are defined using the same network listener ",(0,i.jsx)(n.code,{children:"default"}),"."]}),"\n",(0,i.jsx)(n.li,{children:"The first server is used by default as no host is specified."}),"\n",(0,i.jsxs)(n.li,{children:["The second server defines a host to limit its access from the host ",(0,i.jsx)(n.code,{children:"admin.example.org"}),"."]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"directives",children:"Directives"}),"\n",(0,i.jsx)(n.h3,{id:"listeners",children:(0,i.jsx)(n.code,{children:"listeners"})}),"\n",(0,i.jsx)(n.p,{children:"Syntax:         listeners:\nType:           list\nItem type:      string"}),"\n",(0,i.jsx)(n.p,{children:"This list defines the names of listeners to map from."}),"\n",(0,i.jsx)(n.admonition,{type:"warning",children:(0,i.jsx)(n.p,{children:"At least one listener is required to start an instance."})}),"\n",(0,i.jsx)(n.h3,{id:"routes",children:(0,i.jsx)(n.code,{children:"routes"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"    Syntax:         routes:\n    Type:           map\n    Map key:        string\n    Map value:      object\n    Default:        -\n"})}),"\n",(0,i.jsx)(n.p,{children:"This map defines each server routes."}),"\n",(0,i.jsx)(n.p,{children:"Depending of its name a route can have different types:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"an internal route triggers a specific behavior of the server."}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["a regular route matches the request path i.e. the ",(0,i.jsx)(n.em,{children:"route path"})," is matching."]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"The route selection order may vary depending on which internal route may or may not have a higher priority."}),"\n",(0,i.jsxs)(n.admonition,{type:"tip",children:[(0,i.jsx)(n.p,{children:"Keep your configuration ordered like this:"}),(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["first the internal routes starting from the lowest priorities to higher (i.e. ",(0,i.jsx)(n.code,{children:"default"}),")"]}),"\n",(0,i.jsx)(n.li,{children:"next the regular routes with names delimited by quotes (excluding the trailing colon as map key)."}),"\n",(0,i.jsx)(n.li,{children:"each route must define first the middlewares chain and next the handlers chain."}),"\n"]})]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Example:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:'routes:\n  default:\n    middlewares:\n      middleware1:\n        # ...\n      middleware2:\n        # ...\n\n    handler:\n      defaultHandler:\n        # ...\n\n  "/route1":\n    # ...\n\n  "/route2":\n    # ...\n\n  "/route3":\n    # ...\n'})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Internal routes"})}),"\n",(0,i.jsx)(n.p,{children:"The available internal routes are:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"default"}),": the configuration of this route is applied if no regular route matches the request. Its priority is lower\nthan regular routes."]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Regular routes"})}),"\n",(0,i.jsx)(n.p,{children:"The regular routes have these naming conventions:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["it must start with a ",(0,i.jsx)(n.code,{children:"/"})," character."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["if no trailing ",(0,i.jsx)(n.code,{children:"/"})," is present, the route matches strictly the request path."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["if a trailing ",(0,i.jsx)(n.code,{children:"/"})," is present, the route will match all children of this path, excepted if another regular route is\nalready defined."]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.admonition,{type:"info",children:(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"default"})," internal route is different from the regular route ",(0,i.jsx)(n.code,{children:"/"})," as the former allows to reuse its configuration by\n",(0,i.jsx)(n.em,{children:"default"})," to other defined regular routes but without configuration."]})}),"\n",(0,i.jsx)(n.admonition,{type:"warning",children:(0,i.jsx)(n.p,{children:"Regular expressions or glob patterns are not supported for routes names."})}),"\n",(0,i.jsx)(n.h4,{id:"routes-middlewares",children:(0,i.jsx)(n.code,{children:"middlewares"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"    Syntax:         middlewares:\n    Type:           map\n    Map key:        string\n    Map value:      object\n    Default:        -\n"})}),"\n",(0,i.jsx)(n.p,{children:"This map defines the server middlewares of the given route."}),"\n",(0,i.jsxs)(n.p,{children:["Each middleware will be executed one after another composing ",(0,i.jsx)(n.em,{children:"the middlewares chain"}),". The middlewares chain of the\ndefault route is commonly called ",(0,i.jsx)(n.em,{children:"the default middlewares chain"}),"."]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Example"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:'routes:\n  "/path":\n    middlewares:\n      logger: # first middleware executed\n\n      compress: # second middleware executed\n        level: -1\n'})}),"\n",(0,i.jsxs)(n.admonition,{type:"tip",children:[(0,i.jsxs)(n.p,{children:["To prevent the execution of the internal ",(0,i.jsx)(n.code,{children:"default"})," route middlewares chain, specify an empty chain:"]}),(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:'routes:\n  default:\n    middlewares:\n      logger:\n\n  "/path1":\n    # this route will inherit of the middlewares chain from the default policy\n\n  "/path2":\n    middlewares:\n      # an empty chain will prevent inheriting\n'})})]}),"\n",(0,i.jsx)(n.h4,{id:"routes-handler",children:(0,i.jsx)(n.code,{children:"handler"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"    Syntax:         handler:\n    Type:           object\n    Default:        -\n"})}),"\n",(0,i.jsx)(n.p,{children:"This object define the server handler of the given route."}),"\n",(0,i.jsx)(n.p,{children:"The handler will be executed after the middlewares chain."}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Example"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:'routes:\n  "/path":\n    middlewares:\n      logger: # first middleware\n        file: access.log\n      compress: # second middleware\n        level: -1\n    handler:\n      app:# handler\n      # ...\n'})}),"\n",(0,i.jsx)(n.admonition,{type:"warning",children:(0,i.jsx)(n.p,{children:"If no handler is defined, an HTTP 503 error is returned."})})]})}function h(e={}){const{wrapper:n}={...(0,s.a)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(c,{...e})}):c(e)}},1151:(e,n,r)=>{r.d(n,{Z:()=>d,a:()=>l});var i=r(7294);const s={},t=i.createContext(s);function l(e){const n=i.useContext(t);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:l(e.components),i.createElement(t.Provider,{value:n},e.children)}}}]);